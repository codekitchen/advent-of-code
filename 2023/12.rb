#!/usr/bin/env ruby --yjit
### LOL this turned into a mess
### functions `a` and `b` are dead code, approaches that weren't fast enough
### dunno why it took me so long to come up with approach `c`

###
# impl
###
require_relative './../utils'

def runs(row) = row.scan(/#+/).map(&:size)
def matches?(row, nums) = runs(row) == nums
def unfold(row, nums, n=5) = [([row]*n).join('?'), nums.cycle(n).to_a]
assert_eq unfold('.#', [1], 5), ['.#?.#?.#?.#?.#', [1,1,1,1,1]]
def prefix_matches(n1, n2)
  n1.size.downto(0) { |n| return n if n1[0...n] == n2[0...n] }
end
assert_eq 2, prefix_matches([1,2,3,4], [1,2,6,5])

def a(field, nums, pr=false)
  puts "searching #{field} #{nums}" if pr
  counts = 0
  qs = (0...field.size).select { field[_1] == '?' }
  tmpl = field.gsub('?', '.').freeze

  puts "qs1 #{qs}" if pr
  qs = qs.reject { |i| str = tmpl.dup.tap { _1[i] = '#' }; sizes = runs(str); (sizes.max || 0) > nums.max }
  puts "qs2 #{qs}" if pr

  return matches?(tmpl, nums) ? 1 : 0 if qs.empty?

  total_broken = nums.sum
  starting_broken = tmpl.chars.count('#')
  needed_broken = total_broken - starting_broken

  n = needed_broken
  puts "search space #{qs.combination(n).size}" if pr
  qs.combination(n) do |brokens|
    str = tmpl.dup
    brokens.each { |i| str[i] = '#' }
    (counts += 1;) if matches?(str, nums)
  end
  puts "found #{counts}" if pr
  counts
end
assert_eq 1, a('???.###', [1,1,3])
assert_eq 10, a('?###????????', [3,2,1])

def b(field, nums, pr=false)
  total = nums.sum
  defs = (0...field.size).select { field[_1] == '#' }.to_set

  # for each num
  #   find all ranges the num could fit in, if all ? were #
  # for each product of those sets of ranges
  #   check that they aren't touching and don't overlap
  filled = field#.tr('?', '#')
  ranges = nums.map do |n|
    starts = (0..(filled.size-n)).select { |i| (i==0 || filled[i-1] != '#') && filled[i...n+i] =~ /^[\?#]+$/ && filled[n+i] != '#' }
    starts.map { _1...n+_1 }.map(&:to_set)
  end

  wut = ranges[0].product(*ranges[1..]).select do |rs|
    rs = rs.sort_by { _1.min }
    rs.map(&:size) == nums &&
    (defs & rs.inject(:|) == defs) &&
    rs.each_cons(2).all? { |a,b| b.min - a.max > 1 }
  end
  wut.map { |rs| rs.inject(:|) }.uniq.size
end

def valid_loc?(field, pos, sz)
  pos+sz <= field.size &&
  (pos == 0 || field[pos-1] != '#') &&
  field[pos...(pos+sz)] =~ /^[\?#]+$/ &&
  field[pos+sz] != '#'
end
def valid_locs(field, start, num, rest)
  rpad = rest.size + rest.sum
  next_hash = field.index('#', start) || field.size
  right = [next_hash+1, (start+field.size-rpad)].min
  # puts "searching #{start} ... #{right}"
  (start...right).select { |i| valid_loc?(field, i, num) }
end
assert_eq valid_locs("???.###", 0, 1, [1,3]), [0]
assert_eq valid_locs("???.###", 2, 1, [3]), [2]
assert_eq valid_locs(".??..??...?##.", 0, 1, [1, 3]), [1, 2, 5, 6]
assert_eq valid_locs(".??..??...?##.", 7, 3, []), [10]
assert_eq valid_locs("#..?..", 0, 1, []), [0]
assert_eq valid_locs("?..#..", 0, 1, []), [0,3]

MEMO = {}
def c2(field, start, num, rest, starts=[])
  k = [start, num, rest]
  return MEMO[k] if MEMO.key?(k)
  unless num
    return 0 if field.index('#', start) # dangling '#' char
    # puts "found #{starts}"
    return 1
  end
  ret = valid_locs(field, start, num, rest).sum do |l|
    # puts "#{num} #{field.dup.tap { _1[l,0] = '>' }}"
    c2(field, l+num+1, rest[0], rest[1..], starts+[l])
  end
  MEMO[k] = ret
  ret
end

def c(field, nums, pr=false)
  MEMO.clear
  # find each valid location for nums[0]
  # for each, find each valid location for nums[1]
  # etc
  c2(field, 0, nums[0], nums[1..])
  # valid_locs(field, pos, nums[0], nums[1..]).sum do |l|
  #   c2(field, l+nums[0]+1, nums[1], nums[2..])
  # end
end

def parse(line)
  field, nums = line.split(' ')
  nums = nums.split(',').map(&:to_i)
  [field, nums]
end

def part1(input)
  input.lines.sum { |l| c(*parse(l)) }
end

def part2(input)
  input.each_line.with_index.sum { |l,i| c(*unfold(*parse(l)), false) }
end

###
# data and runner
###

SHORT = %{???.### 1,1,3
.??..??...?##. 1,1,3
?#?#?#?#?#?#?#? 1,3,1,6
????.#...#... 4,1,1
????.######..#####. 1,6,5
?###???????? 3,2,1}
FULL = DATA.read

puts "part1 short", (part1 SHORT).inspect
puts "part1 full", (part1 FULL).inspect
puts "part2 short", (part2 SHORT).inspect
puts "part2 full", (part2 FULL).inspect

__END__
.???##?????????#?.?? 1,12
#####??.?????? 7,1
#.???#???.#? 1,2,1,1
?#???#?..???# 2,1,1,1
?#..???.#?.?.. 1,2,2,1
?#?????#?#??#?????# 2,1,8,1,1
?#???????? 1,4,1
#???#??#?##.???? 1,1,7,1,1
?#?.#???#?###??? 2,3,8
.??#????#. 3,1
??#.??#??#?? 1,1,2,1
?#??#?#??.?.#.#?? 8,1,1,3
????###??#.???#..?? 7,3,1
.##????.?? 3,2,1
#.#???#?##??.????.? 1,2,7,1,2
.#?.??#?????.??.?? 2,8,1
#???..?.?. 3,1
????#?#???..??? 1,6
?????#???.??.???? 6,1,1,1,2
?..?.#????#?###?#? 1,1,1,10
.#??#?????#. 4,5
.?????????. 1,4
.??.?.#?#??. 1,4
??##???.#???#??.? 5,3,2,1
?#????#??.? 1,4,1
#??#.??###???. 4,5,1
?#?.#??.???# 3,2,3
?#??.???#??? 1,1,5
???.#????.? 2,4,1
???#?.#??#???#?.?# 1,1,1,1,3,1
???.#???.?#???? 1,1,3,2,1
.#??##????. 5,2
?????#???????.??? 3,4,1,1,3
?...???####????#? 1,13
.?##?#????????#???. 6,6
???.?#???? 2,3,1
.????????#???? 5,3,1
..?#??..??.?? 4,1,1
.?#???.?#? 2,1,1
#??..???????#? 2,1,5
??#????..??.???. 3,1,1,1
..#??.????? 3,3
.#?????#?..?.#?? 2,1,3,1,1
##???..????? 4,2
???????????#.? 1,5
.#?#???????#???? 3,1,5,1,1
?????#?????. 2,2,1
?.?????###?? 2,4
???????#???#?????? 1,1,7,1,1
?#????##?????????? 9,1,1,1
???????.??#????#? 6,2,1,1
?#???..??????? 4,3,1
.#?????#?# 4,4
???????.???????. 2,3,2,3
????#?#????????.??# 12,1,1,1
.##..?.?##?#?.?.# 2,4,1,1
#?##??#??.# 8,1
?????.??#????? 1,1,6
??.?..?#?.??. 1,2,2
????#??..????? 2,1
?.#???##???.? 1,1,2,1
????????#?? 1,1,4
?#???.??###????.? 4,5,1
??.?.??#?#.???#???? 1,1,1,3,6,1
.???#????????? 1,7
?###????#?????.?#. 4,8,2
?#?????????? 8,1
?.#?#???###?.???? 1,8,1
????#?.#???????.?? 1,8
#????????.?#??# 2,1,1,2,1
?.??.??#..?#.??? 1,1,2,2,2
?????.#??.?? 1,3
##??.?###????? 4,7
?.?#?###??? 1,2,3
.?????.???#? 2,4
.??#.?##???#?? 1,5,1
?##.??#????#???????# 3,5,1,1,1,2
#??#???#.???###???? 1,1,2,5,1,1
??.??.?????##?.?? 1,1,5,2
.#??.??#???##?#.?#? 1,1,2,2,1,2
??????####??##..?? 14,1
????.??#?????#??... 1,1,6,1,1
??#?.??.#.. 3,1
.#?#????????.. 5,4
???#?????#??#? 2,7
????#?????#?#??#.? 8,1,1,1,1
?#?????##.?????????? 9,1,1,1
?#????.??#?#.??.# 1,1,5,1,1
?????#?..? 1,3
?.???#?#????##? 8,3
???..?..??#?.#??##?. 2,1,4,6
?###??.?#?#?????? 5,4,2
?..##???????????? 4,5
.??#.????????#..???? 1,6
?###??????.????? 10,3
?.#.??.?????#..??. 1,2,2,1,1,1
??#???????#.# 8,1,1
??.#?...?#????? 1,1,2,4
.??????#????? 8,2
?#?#??..??.??# 3,1,3
.?????.????. 1,2
?????..??????? 1,2,3,1
..#?.??#.##??#??? 1,1,1,6
????.?.?..? 2,1,1
.#???.??.??? 1,1,1,1
?.???#..??????? 1,3,6
.?#.??..?? 1,1,1
????????.#? 3,1
???#?????? 1,2,2
???#####???#?.?#.??. 12,1
????..??.? 2,1
.???????.???? 3,1,2,1
??#?#???#??#??.???. 8,1,1,3
?????###.???? 8,2
.??..?.?#?? 2,3
#?.????..? 1,2,1
??????????##.#?#. 1,8,1,1
.#????##??.?.#?? 1,1,4,1,2
?###???.??.???.? 3,1,1,1,1
.#?.?#???????? 2,1,2,3
#???#?##???#?#??. 8,5
.?#???????????.#?#? 4,2,3
?##.??..??? 2,1
?..???????????? 1,2,2,1,1
.#?.??#??? 2,2
???.???.???..#????? 2,2,1,1,3,1
?#??????#. 3,4
?.????#?#?????# 7,5
??#????.?#??.. 2,2,3
.#?????#??#??#??.?? 1,4,1,2,1,2
???..?#???? 3,1,1
#??#??????...?? 1,1,3,1,1
?#??.?..#??????# 4,3,4
??.??.??????.? 2,3,1
..#?..?#???. 1,2
.?????#?.? 3,1
?#??#??#?#?#.??? 1,9
##???.????.?#??.??? 4,1,1,3,1
.?.?.?.????????? 1,1,4,1
??.#????#.???##???.? 1,3,1,1,5,1
#.??#?.?.?..? 1,2,1,1
???.#?.???. 1,2,2
?..#?.?#??????? 1,2,6
#?.?##?#?? 1,3,1
#?#.???#?#???.? 3,5,2,1
##..?.????##?#?#???? 2,1,1,9,1
.?#????.???? 2,4
???..###?#??# 2,5,2
#???.????#??? 4,2,1,1
..?#??????..? 2,4
??...????#.?? 1,3,1,1
?.??##?#???.??????? 6,7
???#?.?????#? 1,1,1,1
??#?????????.??#?.?? 1,1,2,4,3
?????#?#??#??????? 1,4,1,6,1
?#???#.?#??? 2,1,1,3
?##.??#?????.???. 2,3,3
??#????.??? 1,5,1
??##?????????????? 3,3,1,5
???.?##????? 1,5,1
?#??#.???#?????## 1,1,6,3
.?.??#?.???#?? 2,4
???##???.??????#???? 7,1,1,5
??????#????.?..? 3,1,3,1,1
?#??##???.???#.????# 7,1,1,1,1,1
???????#.??? 1,6,2
.#.?#?.?#? 1,1,1
?#???#????#?.#?????? 10,1,2,1
.?#?####??#???????. 6,9
#?..?#.?#?#????#? 1,2,8
.??#?##?.????#??#. 2,2,8
????#..???????? 1,1,2,2
??#???#..?##????? 1,2,1,8
.????????##???. 6,4
????#?...??.?.?#.# 5,1,1,1,1
??.?????..#?? 1,1,1,3
?????.???? 3,1
.????????.??.???? 1,4,2,1,1
?#??#???.????????? 7,2,2
???#????.#.??##??? 4,1,4
#??##..#?????. 1,2,2,1
???????#???.?.?#?. 4,2,1,3
??.???#.?.???. 2,3,3
???.???#???.??##? 1,7,4
????##.?#??##..?? 6,1,2,1
.??.???#????#.?.? 2,1,3,2,1
????????#?#?#? 2,5,4
.???????.?#?#?. 5,5
?.###???.???????##?? 5,1,1,6
??????#??#??#???.#? 1,1,9,1
?#???#.?????# 6,2,2
???.#??????. 2,3,1
.????##?????.? 9,1
????#..#.??? 1,1,1,1
?##?..???????????#.? 4,9
?#?????.?? 3,2,2
#??????#??????.? 8,1,2,1
?#.?#?????#..#??? 2,4,2,1,1
#????????????.#?? 1,6,2,3
???#???.#.? 4,1
?#??#?#.???#??????. 6,4,2
??##???????#????.?# 1,8,1,2,2
?#????#?#.???.?# 2,4,1,1
?##????#?# 3,5
?.?..??#.#?. 1,1,1,1
?#.???????.?? 2,3
?#???#????.? 8,1
?#?.??????#. 1,6
#?#.???.?? 3,3,1
?.#?????????????#? 10,1
???????#??.?#?? 2,4,2
?#???##??##??#???#?? 8,2,1,3,1
?#???#???##? 2,6
??.???##?. 2,3
?????????.???..?#?? 7,1,1,3
.?#??..??#?? 4,3
???.???#????.???? 1,5,2,1
?#.???##???#.. 2,6
?#?.???.??#??#.??.. 2,3,3,1,1
?#???????##???.??#? 14,1
#?.#????..?.? 1,1,2
??..???????#?.??. 1,7,1
?#??#??????#.????? 2,1,1,3,1,1
?..??.??#?.?? 1,1,3,1
????.??##?#?#??. 2,8
??????##?#?? 1,1,7
???##?.#?#??????#??? 3,13
??#????#????.??. 3,1,2,1,1
???.??????..?.? 2,1,1,1,1
#???###???????. 1,6,2
??#?#.##???.????##? 3,1,4,1,4
?.????##????????##?? 4,7
?.###?#.?#??#.??#??. 1,5,3,1,4
.?.?#????? 1,1,3
...??.???. 2,2
.?????#??? 2,2
??????##?#..?????#.? 4,4,1,1,2,1
??##?#??.?.?? 6,1
.???##????..??#???#? 5,7
#???#????? 5,1,1
????????#?. 3,5
?.??#???##?.??? 1,1,1,5,2
???????#?.?. 1,1,2,1
?.##?#.??#?#?.. 4,6
?##??????#.?????? 7,1,2,1,1
?.??????..???.?..? 2,1
?..?????#??? 2,2,1
??#..????? 1,1,1
???????#?.?? 9,1
????#??.??. 6,1
#.?....??????#?? 1,8
?###?#?????##??? 13,1
???.??.???##? 1,5
##.?.?.?##??#?##???? 2,1,10,2
?#??.?.?.? 2,1
???#??#??????.?? 1,1,3,4,1
#?##???#?#.???##? 8,1,4
????.###.????## 1,3,1,1,2
????????.????##?#?? 1,2,1,1,2,6
?.???#?????. 4,1
????#?.??.##?? 1,1,2,3
#??????.??# 3,3,2
..####.#?#.?????##?. 4,1,1,6
??????????#?????? 1,3,2,2,3
?.??#???#?#??????#. 3,10
?#?.#???????#??# 2,4,1,1,1
??????????? 7,1
..??..#?#??#???#??## 2,14
?#?#.????? 1,1,2
#??#??#??#.#?.?.#.?. 7,1,1,1,1,1
??????#?.??.#.????? 1,4,2,1,5
?#????#??? 1,1,3
#?#??#??..??.#???? 8,1,4
??#??#?#?#???#????? 2,1,11
?##??#?#.?????.?? 7,2
#????##?..?. 1,5
????#?#???????#??? 8,1,1,2
???.????.?##????# 1,1,2,4,3
??????##?###?? 1,1,9
???#?.??#?#.?.????# 1,3,1,3,1,1
.#???????##?#?. 10,1
????#???.?????#??? 2,3,2,2
##?.????#?#?? 2,2,5
.?????#???#??#?.#? 1,1,6,2,2
?.??#??.??#?#?#?#?? 1,1,2,11
.?#???#?..? 2,3
.??.??#.?? 2,1
?????#?..?? 1,2,1
.##???#????.#.??? 2,5,1,1
??.??##?????. 2,4,2
..##.??#????????#.?? 2,1,10,1
???###?#??#. 1,8
??..??##??.? 1,4,1
?.?#?#..???#?.#??. 1,3,5,1
??????#?????? 1,1,1,4
??.#???????????#? 1,10,1
???.?????.????????.. 1,5
???####.????? 6,2
#?##?.?????????? 4,2,3
???.?#????.??.?#.? 3,1,3,1,2,1
????????.?.?. 7,1
?.?##?#??.??#?#?#?? 1,6,5,2
.??#???..?#??...??# 2,4,1
#.???????# 1,6
?#.??##.??.????? 1,2,1,2,1
?.?..???#?????? 6,3
?.??#?#?#?? 1,7
???#???#.?#?.???#.# 1,5,1,1,1,1
??.?????#??????.?.? 1,1,4,1,1,1
.?.?????.??# 1,2,1,2
???..#?#?# 1,3,1
?..#?#???????#? 1,4,1,1,1
??#?.???#???#?? 3,4,1,1
????#???????#??????. 1,13,2
?.???#????..?. 1,8,1
??.?#?.?.???##?.?# 1,2,1,6,1
???..???#???###?#??? 2,13
...##??#?.??. 5,1
???.?#?#?? 1,4
?#??????.#? 2,1,1
##?#????#? 4,4
???.#?##????#??????. 1,5,4,1,1
#.??????#. 1,1,1
??????.?..#????#? 4,2,1
??????????##???. 2,1,7
?#?????????? 2,5,1
?.?.????#??? 1,5,1
????.#??##?..?.? 2,6,1
????????#???? 1,1,1,5
.?.????##???#?.??? 1,10,1,1
?.?????#?? 2,2
.????.#??.??#?? 2,2,4
#??.#????#?#????.. 1,12
?##?.??##????? 2,6
?.??.#?#??#####?.# 1,10,1
.??#.?????? 2,4
?????#???.?.##? 1,4,2
??..???..?.??#??. 1,2,3
???##?##?#?#??????.. 1,13
????.?.??.#?#?##???# 1,1,1,10
??#.?????##???????.? 3,11
.?.?..??#??#??? 1,7
??#?#.???.?##??? 1,1,1,1,4
???????#??? 2,4
.?#??##??#?????? 1,5,1,1
?#?#???#?#?.#?#?# 5,3,5
.?..??#?#???#???. 1,10
????#?#?#??.?? 1,4,2,1
?????.#??#??#??? 2,8
??.?#?????????#???.# 1,13,1
?????#????#?? 1,1,5
?????#???.??#?? 5,2,3
?.?.????#.. 1,4
??.???????#????.#?? 2,1,1,1,2,2
???.#???????#. 1,1,5
????#?#.?#??.???.?? 1,5,1,1,1,1
.??.#???.#??#??.?# 1,1,1,4,1,1
????.?????##?? 2,1,4
??..??????.??? 1,3,2,2
????.?????. 4,2
????..??????##??? 4,1,1,4,1
??..??#?##??.#?? 6,3
#?.?##?#?..??#? 1,6,2
?#???????#.# 2,2,2,1
???..?.??. 1,1,1
.???????.? 1,1,1
?#????????##? 1,2,3
??????#???.?.?##?#. 1,7,3,1
#??????#??? 1,6
?..???#??????? 5,1
??.???.??#??# 2,1,3,2
#?.?#?????#?##???.?. 1,2,8
.#??#???.???.? 1,2,3
#????????#??? 5,3,1
??????#???###. 7,5
????##?????###? 1,4,1,4
?????.????#?#??.? 3,1,1,5,1
??#?#??????#?.?. 2,1,1,1,2
#??????#?.?#? 1,4,2,1
?#???#...???? 2,1,3
???.??##???#.??? 3,1
??.?#?.???#?#?##??# 1,3,1,1,1,5
?..????.?? 2,2
???.?????? 1,1,1
??#??????.????. 7,3
??.????????..??.?#?? 1,1,1,2,2,3
??#.???.?? 1,1,1
?????????#????.?##?? 1,1,7,1,3,1
??????#??##?## 2,1,1,6
#?????.?#???.? 6,4
.?#??#.?#????. 2,1,3
??#?.??#?? 3,3
??#??##??#. 4,3,1
???#????.?.?????.?? 1,3,1,2,1,1
?#?.???????#. 2,8
??.#?????????????#?? 3,3,6
?.??###??#. 5,1
????.?#??? 4,3
?.?.????#???#.# 1,1,1,3,1
.##???#.????. 4,1,1,1
??#?##??????#?? 1,6,1,1
?#??##?..??#?. 5,3
#?#????#.#??#? 3,2,1,4
??#???#?.? 1,2
??##?#?.#?#???? 1,4,3,1,1
?#??.???###??. 3,5
??.?.?????#????.? 2,4
#???.??#?#???.???? 3,6
?#?#????#.?#???##??? 4,1,10
??.#????????#??.? 1,1,1,6,1
??#??#.????.??. 3,2,1,2
?#.?#?????.#? 1,3,1,1
????.??.?????.?? 2,2,3,1
?#.????..???.# 2,2,1,1
?.??##??#??????. 3,1,2,2
?????#.?##????#.? 2,1,6,1,1
.?###??????.?#? 8,1
.??..##???#?#?? 2,9
.??#?####???.?.? 8,1,1,1
??.?.?.#.? 2,1,1
??????.??#??? 4,1,3
??.?????????..??? 1,2,1,3,1
?.???#??..??##??..? 1,1,1,1,6,1
###???#???????#...#? 13,1,2
#?###?????#?????##? 1,6,4,1,2
.?...?.#??.??##?.? 1,2
??.?.??#.??.? 3,1
??????.?#?##??.? 3,1,6,1
??????#?#.??#?#.. 2,1,2,1,5
?#??#.?.??###???##?? 2,1,1,4,6
#?...?#?#. 1,4
#??#????#?.??.???. 1,7,2,3
??????????#??.?. 1,8,1
????????#??.?.??#.?? 7,2
??#??#?.??#??#???#? 4,10
#?#.?#????? 3,2,2
??#.?????.???? 2,1,1,2
.?#???.#????#?? 2,6
???.?.##??.???? 1,2,1,1,1
???????###.#..#?. 2,2,3,1,2
??#?#??...?#.. 4,1
??..???????.?. 1,1
????#?#??? 3,3,1
????##???? 2,3,2
??.#??.?????#?#? 1,1,1,3,1
.?.??.???. 1,2
??.??#?????? 2,2,1
.?????#.?##??#?#??# 2,1,2,4,1
???#???#???#.??.#?#? 2,7,1,3
?##.?.?.#??#.?#?? 2,1,1,2,2
????.?##.??. 3,2,2
.?#?#?????????##??. 7,1,5
??????###?#??? 3,8
?????#??#.???.?#?.?. 9,1,3
..??##..###?#??? 3,5,1
.##?.#.???.? 2,1,1
..##??#?.???#???. 5,6
???????????#????# 1,5,2,2,2
??##???#????????#?? 1,6,1,1,1
.#????????#. 3,1,1
?#???????.????# 2,1,1,2,1
??.?#????##? 2,4
#?#?????????##?##.? 1,1,1,1,8,1
??.#???#??.#?. 1,4,1
?.?.????#..?? 1,4
????..#??????##??.?. 1,1,11
?#????.?.? 4,1,1
#?????#????#??.???.? 1,1,7,1,1
.??.#?.#????#.#???? 1,2,6,1,1
??#???#??? 5,1
??????#.?????? 6,1
?#??????#?#.?.. 1,4
.?????.??..???#???? 3,1,6
?#?.??#?#?#??#.??. 1,1,8,1
???.#.??.???#??? 3,1,1,6
??#?#????.?? 6,1
?????##????#?#?#??. 4,8
.?#???????#.?#.??#?? 7,1,1,1,1,1
?##?#??#.??# 5,1,3
?.#?????#???????##?? 1,2,11
??#???#??. 1,3
.?.???#???#.#?..? 1,4,1,2
#??.#??????. 1,2,1,1
.??#?###????#? 1,4,3
??.???.?.????.? 1,2
?.?#??.??#.?? 3,1,1,1
?#.????#????. 1,4,1,1
.?##??.?.?#.?# 5,1,2,1
????#???????.?##?. 10,2
???.?#???.????###?# 1,1,2,1,8
?..?#?.##?? 2,3
???????????.#??#?# 2,1,1,1,4,1
???..???.????#? 1,3
.#???#?#?# 1,5
???.#?.#??#??##.?.? 1,1,8
????????#????.?#???? 7,5,4
???.????#?#?? 1,3,4
?..?#?????.##?? 6,3
?????????.???????? 1,1,4,1,2
????#??#?.??#.? 3,1,3
??#..????? 3,3
??#.??#???.#??. 3,3,1,1
??#?.???#?????? 1,1,7,1
????#??#?.????.??#?? 7,1,1,1,1
.??#???#??#?????#?? 2,11
.?#?#?#??? 3,3
????#???##. 3,2
.?#??#???????? 4,6
.??.???###?. 2,5
??.?.?????#?#??? 1,8
???..???#?#?..?#?? 3,1,1,2,2,1
????.?#???##?##? 1,1,1,1,5
?????????????????# 1,1,3,1,5,1
#??#.?#.?. 1,1,1
????.#??#??.??.? 2,4,1
??#?#.?????. 1,3,4
#?#???#?????#.?? 1,7,1,1
?#??????#?? 2,1,1
?????????.###.???? 1,5,3,1,1
??????##??.?#.?? 1,7,2,1
?.??.??????.???? 1,2,2,3
.??????##???..??##? 8,4
.???.?.#??????#???# 2,1,4,7
?#.#????#???? 1,4,5
?..#??##??#?.?#?#??? 1,1,2,2,4,1
??..??????.?? 1,5
???.????#.??#?#????? 2,1,1,10
???????...?# 2,1,2
#.?#??#?#?#?#?.??? 1,4,1,3,1
.??#??.#?# 4,1,1
??????????.????.? 1,4,1,1,1
?????.????#??? 3,2,2
???#??????#????#??? 11,1,2
.?.#?#?#.?. 1,3
??.????##??..# 1,1,4,1
?????#??##??.?#? 1,10,2
..#??#?????? 4,2
.?#??.???#?? 3,5
.?????.??? 1,1,2
?????????. 1,1,2
???.???.?#?.??? 3,1,2,1
???#??.?#?.#.? 2,1,2,1
.#????#???#????? 3,2,3,3
??????#?#.??? 1,4
?.????#??##. 1,2,5
?.??#?#.?? 3,1
????#?#????.#???#?.? 3,4,1,6
????#?#?#?#?#??#??. 9,8
?..?#..### 1,1,3
.????????#?? 7,1,1
?.?#??#??.?????? 3,1,1,1,1
?#??.#?#???#??? 3,1,1,3
?#?.????#?#???.? 2,6,1
??.???.?????? 1,2,2,1
?#??..??????#?# 2,1,2,2,1
??#?????#???#???#?#? 12,2,1
??#???.?#??? 1,4,2
???...#..?#??? 3,1,3
##?.#?#?##????##??? 2,6,3,1
.#?#?.?.???#?#?## 4,8
##??.??????#. 3,6
?#???..#.#.??##?? 1,1,1,1,5
??#??#?#?.#?.#??#?? 1,7,2,1,1,1
.?.???????##??.?? 1,2,3,2
??#????#????.??. 8,1,1
???#?.?#???? 2,2
???#?#?#????? 7,2
????.????? 3,1
###?#?#????? 3,4,2
??#?#??#.?.#?#?##?. 5,2,7
.??.???#..???#??.? 1,1,1,5,1
?#?..???.? 1,3
..?##?.??..#?#?##?#? 3,1,9
?.??.?##??. 1,3
????#???###??.?# 1,1,4,2
#??#...???? 1,1,3
?????..#?# 4,1,1
??#?#?.??.. 4,1
..?#.??#?? 2,2
???.?????#??#?? 1,6,2,1
???.#?##???#??? 2,11
???#????#?#????#??? 2,9,5
??.???.??????? 1,2
??##?...????#?? 4,4
??#??#????? 5,1
?##.??.?.#.?.? 2,2,1,1
.?#.??#???.#?#?..?? 2,5,3,1
?#???##?????#? 9,2
??#??.#?#?.??# 4,1,1,2
#.?#?????? 1,1,1
????#???????.??.? 11,1
??.?#?#???#??#? 2,10
?#??#??#??#??#??#? 8,1,5
?#?#?#?????????#.??# 1,7,1,1,2
.??.???#?. 2,1,1
??...??#?#. 1,4
.??.#????.?.? 1,2,1,1
??#?#.?#???###?#? 3,7,1
?????#???###?.??? 2,1,6,2
?#?#???#.???#?.?.# 8,1,1,1
?.??#?#?#??###??# 1,14
#.??#????????.. 1,5,1
##?#???????#???##??? 9,4,2
.??..???#?? 1,3
##????.?????. 2,1,3
.???.??????.#???## 1,3,1,1,4
#.?##??#??##? 1,7,2
?#??#????? 2,4
.?#???#??#??#?#. 7,4,1
????#?.#??#.. 1,2,1,1
??.?##.?#??#?? 3,1,3
?.????.??#?#????.??? 3,5,1,3
?????#..?###?.???.?# 2,3,5,1,1,2
#?.?.#?.?#?? 1,1,1,1
?#?.???.##.?.?.? 2,2,1,1
#?#???.?#.?????? 4,1,2
?.??????.??? 1,2
.#????#??#?##?.? 2,1,5,1
???#?#???.#. 1,1,1,1
?##??##??????.???? 7,1,2,1,2
#????##?#?..#?#??. 9,1,1
??#??.??#??#????# 1,2,1,1,4
.????#???#???? 5,1,1
???#?.?..???????# 3,4,2
????#?#??#??.????.. 7,2
#?#????#.???..#? 5,1,2,2
?#?#?#??.??????.. 5,1,2
??#??????? 1,5
..??##??.?#??..??? 3,2,1
#????.??????#? 1,1,4,1
?#.#??????#? 1,1,1,3
??.??.???#???. 1,2,1,4
??#?#?????? 4,3
?????.?.??#? 1,1,1,1
??##??#???#?? 6,1
?.????###??#??? 3,1
??????????#??.#? 3,1,1,2,1
????#?.???##?? 1,1,6
?.?#?.??#?????? 2,2,2
#.??##?#?????#?????? 1,10,2,1,1
?.??#???..???? 1,1,2
.##????.??? 4,1
#???..???#??#???#??? 1,1,1,1,9
#.#??#???????#.#?#?. 1,7,2,1,2
??#??#?????#?###??? 5,3,7
?#?#?.??.??? 1,1,1,1
..#????????# 1,2,3,1
?.??#.?#??? 2,2
.#?????.?##???#?? 6,8
?.???#????..??????? 4,1,3,2
????.???#???..? 1,1,2,1,1
#???#??????????? 1,2,1,6
?.??.???#? 1,4
??#????#.??? 4,1,1
????.??.?#??.??? 1,1
#.?.?#??????.?#?.? 1,2,3,3
?##??##??.?..? 2,4,1
???.??#?????###?#?# 1,13,1
????????.?????????#? 2,1,1,9
?#?#??#?????#????? 2,2,1,1,3,3
??..#??.???.???## 3,2,3
?.?#?#???#? 4,1
.?#??#???#??????#.? 10,4
???????????##???.? 1,1,1,1,3,1
..?#??.#???????#?? 1,1,7,1
?????#?#?????? 1,3,2
.??????????.#?????? 2,4
??.#?#?.?.???? 4,2
???#????.?#???# 1,1,3,3,1
??.??????.???.?? 1,3,2
?#.#?????#???###? 2,1,11
????.#?.#????##???.# 2,1,2,5,1
??.##????##?... 3,4
..?#??.??.?##??#??.? 4,6
?#?????????#?. 6,3,2
??.##????????####??# 1,15,1
???.?.????? 1,3
???#?#.?##?? 5,3
.??#?..##? 4,3
?????#??#????.##? 6,2,2,2
??.#??#???##.#. 1,3,2,1
?#.?.????.?. 1,2,1
??.?????????. 2,3,2,1
????#???.? 1,2,1
??????.#???. 1,1,3
#..?.??#?? 1,3
..#.?????????. 1,4,2
?.??????#?????.? 7,2,1
?#??.?.#?###??? 1,1,1,5
.??.?#.??.?.???...?. 2,1
???#?.#?#?.??..?#.? 1,3,4,2,2,1
..??..?#??. 1,4
.??#?????.??????? 6,3
?..??????..???.? 1,2,3
#?????.?#?????#????. 1,1,1,12
?????????.?#??????? 1,5,7
???.?#.???.??? 2,2,2,3
??.?.?.??#.???? 1,3,2
??.????##????# 1,6,1
?.???????.?#. 1,2,1,1
..??#.????.?????? 3,1
??#?#?.###?#??#?#.?? 4,5,2,1,1
??#?..???? 3,2
?#?##.???.#.??##???# 5,1,1,1,4,2
.#.?#?.??# 1,2,3
#?.##??..#???.???#?? 1,2,1,4,3
??#??????????????? 3,1,1,2,1,1
.??.#?.?#??# 1,1,3,1
?.?#??#???????#????? 1,5,3,4,1
???#????#??? 4,3,1
.??#???.??#? 2,4
##?.??.#??#??? 2,1,6
#??#..##..?#. 1,1,2,1
?#?.#?#??#??##.???#? 2,3,2,2,4
..????????.?.??.?#? 1,1,3,1,1,3
#??.??????# 2,5
?.###???????? 3,1,2
.?#??#?#???..????? 2,7,3
?#?##?#??.##?..?#?? 7,2,3
??#?.??..?#?#.# 1,1,4,1
??#????????#.? 9,1
##?#?##????????????? 8,1,1,2,3
#????#?????#???? 9,1,1
?#..???#?.#???#?##?# 1,1,1,10
?.?????##.?#?? 1,4,2
?.????????? 5,2
?#?#?????.??#?##?? 4,2,8
???.#??#.?#??#?.??? 2,1,1,5,2
?#??.?????????#. 4,2,4
.##?????.#.?. 2,3,1
.##..????.? 2,3
?#?#???.????.???? 4,2
##?.???.????? 2,1,5
?#??.?#??? 1,1,5
?.????#??..#?..? 2,1,2
#??????#.. 1,2,1
???#??..?#??? 1,1,3,1
??#???.#??? 6,1,1
???#?????????????? 3,2,6,2
#??????.?????? 4,1,1,1
?????#?#?? 2,6
?##?#???????.???? 2,2,1,1,4
?..?????#?.? 1,3
##..#?.??. 2,2,2
..#??????? 1,2,1
..?????##.. 2,3
??#???????#? 1,3,2,1
#??.#???????????? 3,3,1,4
#??.??#.???? 2,1,2
?????#?.????? 1,2,1,1
????#?##???##??#? 6,8
?.??#?.?????.. 2,4
??.?????#??#? 1,1,5
??????#.#???.?#??? 2,1,1,4,1,1
?#??.???#???..?# 1,1,2,1,2
##???.???###? 2,1,1,4
##?????????????##?#. 5,1,1,7
??..???#???????????? 1,4,1,1,3,1
?..??#??.?##?? 1,1,1,3
.?.??.???#.?.?? 2,1
??????????? 1,4
????#.???? 3,1
??#??????#??.? 2,8,1
.????#?#??????. 6,3
??#?###?.?.???#????? 8,1,1,4,1
????.?#???. 1,5
?.????#????. 1,7
????.????? 3,1
?.#..##??#????? 1,1,9
#?#?#??????##?????? 1,1,10,1,1
??.???.#?? 2,1
.?#????#.???.?.# 4,2,2,1,1
.????#.??? 1,3,1
???????????#???? 1,6,3,1
???.#?.????. 2,2
??#?????#??? 8,1
???????????. 1,1,2,3
???#.????.#?.??# 3,3,1,1,1
????#??..?.#?. 3,1
.##?????#?????.?.?#? 9,2,1,1
????.???????#?? 2,1,6
..??.?#??? 1,2,1
#?.???#.????##. 1,1,1,1,2
?.???#????# 1,1,6
?.????????? 1,6
???#?##???#????.?.? 9,2,1
?.#?#.?????#???###? 1,1,1,1,1,8
???#.?.??.#? 4,1,2,1
???..?..?# 2,2
?????????? 1,2,1
..???#?????#... 1,7
??.????.#????? 1,3,1,3
.?#???#??? 2,1
?????????.??????? 2,1,3,1,5
???.??????#???? 2,6
??##???#?#? 3,1,2
?...?#?.???... 3,2
???#?..?##?? 2,3
#?#??????#???#??#?? 4,13
?????#????. 1,1,1
.?.#?#????#?????.??? 1,6,1,2
????#??????.?? 8,1
.?#???#???.#?# 2,1,1,3
????#.????? 5,1,1
.?#???.?###?.??# 3,5,1
?#???#??????#??.#. 8,4,1
??????#.#???.?? 1,5,2,1,1
#???##.?##?? 1,3,4
#.?.?.???????? 1,1,4,1
?#????#??#?? 2,3,3
#??#???????.#?? 1,1,1,2,1
.????????? 1,1,1
???#?????..??. 9,1
..?#??#?.??..???. 6,2
?.?#????????.?...?? 4,4,1,2
#?.????.??# 1,4,2
.?#?.??.#?????? 1,1,1,4
..#?????.??#???.## 2,1,1,1,1,2
.#???????.?#??. 6,1,3
.#??#?.#?????#??.??? 1,1,1,7,1
?#???.?.?#??? 1,2,1,4
#?.???????????????? 1,2,6,1
???#.??..?? 4,1
#???.#????.? 2,1,2,1
.#??????.#??.? 2,2,2
?.?????#??#.??#?.? 2,4,4
.#???????##. 1,1,2
?#??????.#.##? 2,4,1,3
?#????.???#? 5,3
?.??#?#??##.#? 1,4,2,1
???#?#?##??????? 1,6,1,1,1
?..#?.#?#? 1,1,2
????.??.#?? 1,2,1
?#?.?.#?...?? 2,1,2,2
?????????#???. 1,1,1,5
.?#????.???#?? 6,1,2
??.?#????.???#. 1,4,1,1
.???#??.?????### 4,8
??##?????#??? 8,3
?#???????##.? 3,4
??.#???#??#?. 5,1
?#.????#????#.???. 1,1,6,2
???????#???#?? 3,6
??#.?#.???? 2,1,2
????????.?#??????.?? 1,1,1,1,6,1
.?.??????????#?? 5,4
?#?..???#??#??#??? 2,11
??#???.???#??#??? 2,2,6
##?#??##??#?????..?. 9,2,1,1,1
#??????.?.#??#? 1,2,1,1,1
.???.??#?.#?? 1,1,2,1
.???#.?#??#?#??# 4,1,4,2
?.?#???????????.? 2,2
?.????#??????.?? 4,1
?#????????#?.?.# 6,2,1,1,1
..????#?????#. 5,1,1
????#.#???????????? 1,1,1,1,8,1
?...?#?#??? 1,3
?#?????#..?.?? 7,1
??#??????.#?#?#?.?? 4,2,6,1
???#???.??. 4,1,1
???#???#?#?#?#??#??? 2,1,3,9
??.????.???##?# 2,6
???.#????#?#??#??.# 1,1,1,10,1
??????????.??#?#?? 2,5,4
??#????????#?# 1,5,3
????.?..#??? 2,3
.?#??#??.???..?# 1,2,1,2,1
#????????????###?#?? 3,14
???????..?????##?? 2,2,9
?##?#?.???.????.??# 5,1,1,2,1
???#.????###?###.??. 1,1,1,8,1
?#??????#??#? 2,1,6
?..?..??#. 1,1,1
#???????????.?? 1,6,1
.???.?????? 1,3,1
?.????#????##??.? 1,8,1
??#?.?.???.?..? 2,1
?????#????????? 1,1,1,2,1
???????????.?.?# 1,5,1,1,1
??#??.??#??#?????? 3,1,4,2
.????##???# 4,1
???#.?#??.???????# 2,3,5,1
?????#.#?.?.#???. 6,2,4
?.??#????.#??#???# 4,8
#???.?#.#??#.??##?? 1,1,1,4,2,1
?#?.##..#?##.?# 2,2,4,2
???.??????.??????#?# 1,1,1,1,1,9
?.?#??#?#.#? 1,1,3,2
?#????.?#???? 4,3
??#?#?#?.????? 7,1,1
##?#??#??.? 8,1
??#.?###?#?.? 2,6
#?##????????#. 7,1,1,1
??..#???##???.?#???? 1,3,2,2,5
??#?#?.????#?# 3,1,2,4
??????##??.#???? 3,3,3
?#???#.?????#?? 4,1,5
??.??#???????.?#. 1,6,1,2
..??????????#?## 8,1,2
.#???.##??.?#??#?? 3,2,1,1,2
?#???##?.. 1,1,2
.????#?.?##??#..??? 6,6,1
??#???##.?.###??#? 7,4,1
?????????#?#???? 9,1
?#?##?#???#?.. 7,2
.#?.?.????? 1,1,2
?#.?#????#.?? 1,3,1,2
.????#??.??#..??? 4,3,2
???????.?#??###??. 6,7
.???##???#?? 1,4,1
????#?###???#? 1,1,1,7
#?.?.?.?#? 1,1,1
?.##?#?.?#??.#. 4,2,1
??.???.??#?##?.???# 2,2,6,1,1
.???.#..#???.?? 2,1,1,1,1
?#????.?.?# 2,1,2
??#????#?#?.??. 3,1,1,2,2
???.????#.????? 1,4,2
.??##????#?.???. 5,4,1
?##??#????#??# 2,2,1,4
?#????.#?#???#?? 2,2,7,1
????#..?#? 4,3
#.?.#?????#? 1,1,2,3
??#??????#?.??? 5,1,1,1,1
??????#.#? 1,2,2
??#.??????#? 3,4,2
#?????#??.?.##????? 1,1,4,1,5,1
??.??.???#???##????. 1,6,4
.?#?.?..?#? 2,3
?#??????.?#?.# 5,1,2,1
??#????#??.#?#? 7,3
??#??#?.????#? 1,2,5
???.???..??????? 2,3,3
???#???#??? 1,7
#???.???#??? 1,2,1,3
?????.?.#??.??# 2,2,1,2,2
??.?#?????????#??##? 1,16
??.???????????? 2,6,3
?????#?????##?..??# 1,1,2,7,1,1
.#?.??????##??.?.?? 1,2,5,1,1,1
?#???.????.? 1,1,4,1
????????#?#????? 1,1,11
????###.?#??.#? 1,3,2,1
#??.???#??????? 3,4,3
?#?????..? 2,1,1
????##????#???????## 3,3,8,2
?????.??###????? 2,4,1
.?#??#???.?? 2,1,1,1
????#??.?????. 5,1,1
?#?????.??.????# 5,1,1,1,3
?##.??????# 3,5
??##???#????.?#.?? 7,3,1,1
?..#.??##???.?? 1,7,1
?#?##?????#??.?# 1,10,1
??.?#?#.????#??. 4,1
.?????#?##.??. 1,7
???#.???.?#????? 1,5
#?.???????.??? 1,1,5,1
?##??#???## 7,2
#?##??????.. 7,1
#...????????##?##?? 1,3,7
???#?????#?????#? 3,8
?#???#??#.????.??# 1,1,4,1,1,1
??#??#?????????? 4,1,1,1
?.?????##????##????? 1,1,8,2,1,1
?????#???? 5,1
?.??.###?##??#? 1,1,3,2,2
????.??..?? 4,1,2
??.????#.?# 5,2
#.#??.?????? 1,1,1,2
..#??#??.??????#??? 6,6
.#?.??##???.#?#. 2,3,1,3
?????.??.?????????.? 3,7
.##?#????# 4,1
?#???#??#??.#.?# 2,1,3,1,1
??????#???. 1,1,4
.#??###?????#?? 1,11
.????#?????#?##.??.. 10,2,1
??.##?.???#????.# 1,2,8,1
.??#?????????.? 1,1,4,1,1
?#?##?.???? 4,1
.??????#?.?#? 5,2
?.???###.????.?.? 1,6,3,1,1
##??##????????##?#? 7,1,6,1
??#??????????###?? 2,1,1,6
?.??.#.??#????. 1,1,1,1,2
????????.??#? 8,1,1
?.??????.##??#.#?.# 1,1,2,5,1,1
..?#?#???.??.??.?? 6,1
.????#.##?#?##.#??? 1,1,1,7,1,2
??#???#??#?#??? 12,1
#???????????#?#????? 1,2,1,1,6,1
???#..?????#??. 1,1,7
??##???###??.?#?#?.? 12,4,1
??????#.?##.?#???#? 1,2,2,3,1
??.??.?##???????#. 2,1,11
.??#????##??? 3,4
.??#???#????#??.? 14,1
?#????..#??????.. 2,1,7